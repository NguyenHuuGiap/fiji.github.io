<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
  <head>
    <title>Bug 305 &ndash; Memory value in ijm.cfg file is ignored - it is always 758MB</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<link rel="Top" href="">

  


  
    
      

      
      



    
    <link href="../css/global.css"
          rel="alternate stylesheet" 
          title="Classic"><link href="../css/global.css" rel="stylesheet"
        type="text/css" ><link href="../css/bug.css" rel="stylesheet"
        type="text/css" >

    <link href="../css/dusk.css" rel="stylesheet"
        type="text/css" title="Dusk">

    

    

    


    


    

    
    
    
  </head>



  <body onload=""
        class=" bz_bug bz_status_RESOLVED bz_product_Fiji bz_component_ImageJ1 bz_bug_305 yui-skin-sam">



<div id="header">
<div id="banner">
  </div>

<table border="0" cellspacing="0" cellpadding="0" id="titles">
<tr>
    <td id="title">
      <p>Bugzilla &ndash; Bug&nbsp;305</p>
    </td>

    <td id="subtitle">
      <p class="subheader">Memory value in ijm.cfg file is ignored - it is always 758MB</p>
    </td>

    <td id="information">
      <p class="header_addl_info">Last modified: 2012-01-05 23:58:53 CST</p>
    </td>
</tr>
</table>


</div> 

<div id="notice">
  <table>
    <tr>
      <td style="font-size: 72px; color: firebrick; padding: 0 10px 0 10px">&#9888;</td>
      <td>
        <p style="margin: 0.4em">
        NOTICE! This is a static HTML version of a legacy Fiji BugZilla bug.
        </p>
        <p style="margin: 0.4em">
        The Fiji project now
        <a href="https://imagej.net/Issues">uses GitHub Issues</a> for issue tracking.
        </p>
        <p style="margin: 0.4em">
        Please
        <a href="https://github.com/fiji/fiji/issues/new">file all new issues</a>
        there.
        </p>
      </td>
    </tr>
  </table>
</div>

<div id="bugzilla-body">


<div class="bz_alias_short_desc_container edit_form">
     <a href="305.html"><b>Bug&nbsp;305</b></a> -<span id="summary_alias_container" class="bz_default_hidden"> 
      <span id="short_desc_nonedit_display">Memory value in ijm.cfg file is ignored - it is always 758MB</span>
     </span>
  
       
    <div id="summary_alias_input">
      <table id="summary"> 
        <tr>
            <td colspan="2">
          </td>
        </tr>
        
        <tr><th class="field_label "
    id="field_label_short_desc">

    <label for="short_desc" accesskey="s">

  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
  >Summary:</a>
</label>
</th>
          <td>Memory value in ijm.cfg file is ignored - it is always 758MB
          </td>
        </tr>
      </table>
    </div>
  </div>
  
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a>Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          FIXED
      </span>
    </td>
  </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components."
      class="field_help_link"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >Fiji</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Unclassified</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >ImageJ1</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">

    <label for="version">

  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
  >Version:</a>
</label>
</th>
        <td>unspecified
  </td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">

    <label for="rep_platform" accesskey="h">

  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
  >Hardware:</a>
</label>
</th>
      <td class="field_value">PC
       Windows
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label for="priority" accesskey="i">
          <a><u>I</u>mportance</a></label>:
      </th>
      <td>P1
       critical
      </td>
    </tr>            
          
          <tr>
      <th class="field_label">
        <a>Assigned To</a>:
      </th>
      <td><span class="vcard"><span class="fn">Johannes Schindelin</span>
</span>
      </td>
    </tr>

    
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">

    <label for="bug_file_loc" accesskey="u">

  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
  >URL:</a>
</label>
</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>
    
  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>
    
  </td>
  </tr>
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table cellpadding="3" cellspacing="1">
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2011-05-04 15:34 CDT by <span class="vcard"><span class="fn">Sebastian Rhode</span>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2012-01-05 23:58 CST 
    </td>
  
  </tr>
         <tr>
      <th class="field_label">
        <label for="newcc" accesskey="a">CC List:</label>
      </th>
      <td>0 
          users
        <div id="cc_edit_area">
          <br>
        </div>
      </td>
    </tr>
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" ></td>
    </tr> 
         
         <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
         
                

        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts" cellspacing="0" cellpadding="0"><tr>
  <td>

    



  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments">






<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table" cellpadding="0" cellspacing="0"><tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sebastian Rhode</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-05-04 15:34:43 CDT
        </span>
      </div>



<pre class="bz_comment_text" >Start Fiji and enter 1532MB for the memory.
Check ijm.cfg file --&gt; &quot;-Xmx1532m&quot;  --&gt;  OK
Restart Fiji and check the ijm.cfg file again --&gt; still -Xmx1532m --&gt; OK
Check the availbale memory under Edit/Options/ Memory &amp; Threads --&gt; Maximum Memory is 758MB
recheck the ijm.cfg file --&gt; &quot;-Xmx758MB&quot; --&gt; the value was changed.

The system has much more Memory available (4GB), so 1532MB should work.
What confues me, inside the information below, it says

os.name = WindowsXP - but the system is Windows7 Ultimate SP1 with 8 cores.

Cheers,  Sebi 


Information about your version of Java - this information is useful for the Fiji developers:

  os.arch =&gt; x86
  os.name =&gt; Windows XP
  os.version =&gt; 5.1
  java.version =&gt; 1.6.0_24
  java.vendor =&gt; Sun Microsystems Inc.
  java.runtime.name =&gt; Java(TM) SE Runtime Environment
  java.runtime.version =&gt; 1.6.0_24-b07
  java.vm.name =&gt; Java HotSpot(TM) Client VM
  java.vm.version =&gt; 19.1-b02
  java.vm.vendor =&gt; Sun Microsystems Inc.
  java.vm.info =&gt; mixed mode
  java.awt.graphicsenv =&gt; sun.awt.Win32GraphicsEnvironment
  java.specification.name =&gt; Java Platform API Specification
  java.specification.version =&gt; 1.6
  sun.cpu.endian =&gt; little
  sun.desktop =&gt; windows
  file.separator =&gt; \

The up-to-date check says: Up-to-date

Information relevant to JAVA_HOME related problems:

  JAVA_HOME is set to: C:\PROGRA~1\TILLPH~1\LIVEAC~1\Fiji/java/win32/jdk1.6.0_24/jre
  fiji.dir =&gt; C:\PROGRA~1\TILLPH~1\LIVEAC~1\Fiji

....

was too long to copy &amp; paste it.</pre>
    </div><div id="c1" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Johannes Schindelin</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-05-05 09:39:51 CDT
        </span>
      </div>



<pre class="bz_comment_text" >On 32-bit Windows, you cannot reserve more than 2G (unless you reboot Windows into a special mode where you can use 3G). Often, not even 1.5G are possible due to user-space libraries fragmenting the address space. My guess is that this is happening on your side, and that Fiji is trying to restart reserving a smaller amount of memory. You should see a message to that end, at least when starting Fiji from the command-line with the option &quot;--console&quot;.

Unless your CPU is 64-bit (in which case you can switch to fiji-win64), there is not much we can do, I am afraid...</pre>
    </div><div id="c2" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sebastian Rhode</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-05-05 11:18:55 CDT
        </span>
      </div>



<pre class="bz_comment_text" >Hi Johannes,

i am not sure about your answer. We tried to serve 500MB or 1532MB or ...

The problem is, even so the entry inside the ijm.cfg file is changed, after the restart of Fiji, the old value 758MB was recoverd from somewhere ...

And today I tested on my on PC (WinXP 32 bit). There Fiji displays 1532MB. I tried to change it to 500MB, but no sucess.
After the restart I ended up with the 1532MB again. So We have no idea, where Fiji recovered this old value from?

Cheers,

Sebi</pre>
    </div><div id="c3" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sebastian Rhode</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-05-05 11:37:36 CDT
        </span>
      </div>



<pre class="bz_comment_text" >Hi Johannes,

we tested an older Fiji (the orignal release for March). And there there it works fine. We can change the memory and it works. So something broko afterwards.
I also tried editing my FIJI shortcut to:

&quot;C:\Programme\TILL Photonics\Live Acquisition\Fiji\fiji-win32.exe&quot; --mem 1528m

And after starting FIJI we got 1524MB memory, which is fine.

Cheers, Sebastian</pre>
    </div><div id="c4" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Johannes Schindelin</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-05-05 12:11:08 CDT
        </span>
      </div>



<pre class="bz_comment_text" >Thanks for investigating further. Unfortunately, I lack the time to dive into that detail these days, so hopefully somebody else will be able to look into this.</pre>
    </div><div id="c5" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sebastian Rhode</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-07-14 17:03:25 CDT
        </span>
      </div>



<pre class="bz_comment_text" >Hi,

since today my Fiji (up-to-date) is only able to allocate 896MB of memory and all attempts to change this do not work.
- I tried to set the memory bach to 1500MB (I use Windows XP with 3GB RAM) from inside FIJI --&gt; no sucess, after the restart = 896MB
- I tried to edit the ijm.cfg file and restarted FIJI --&gt; no sucess, 896MB
- and I tried to start FIJI from the command line &quot; ...\Fiji\fiji-win32.exe --mem=1500m --&lt; but no sucess, after the restart = 896MB

And now I ran out of ideas what the problem might be. A while ago I submitted a bug (ID 305). After doing that I added &quot;--mem=1500m&quot; to my FIJI shortcut. and that solution worked until yesterday. And now I am stuck with 896MB which is quite limiting for what I do. </pre>
    </div><div id="c6" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Johannes Schindelin</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-07-14 18:16:04 CDT
        </span>
      </div>



<pre class="bz_comment_text" >Have you had a chance to start Fiji with the --console option? I am pretty certain that it tries to reserve as much heap as you ask it to, but fails, settling for less. Most likely another application got in the way and &quot;fragments&quot; the memory, i.e. disallows Java to use as much contiguous memory as it wants to.</pre>
    </div><div id="c7" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Stephan Preibisch</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-07-15 12:55:25 CDT
        </span>
      </div>



<pre class="bz_comment_text" >Hi Johannes,

I have the same problem under WindowsXP64 and Windows7-64, he simply ignores the memory settings, for example I also cannot set it to a lower value than the default one ...


</pre>
    </div><div id="c8" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sebastian Rhode</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-07-15 13:13:41 CDT
        </span>
      </div>



<pre class="bz_comment_text" >Hi,

i tried some things to pin down the problem.

- I shut down all unnecessary windows applications.
- I downlodead the FIJI relaese from the homepage and started Fiji --&gt; 1532MB are the limit --&gt; OK
- I ran Fiji´s updater --&gt; end up with ImageJA 1.45k and all plugins updated --&gt; 1148MB limit is now the limit

So a change within Fiji itself causes the decreased memory allocation?

And I started my normal ImageJ (ImageJA 1.45k) and end up with 1532MB limit, which is fine.

Hope this helps a bit.

Sebi</pre>
    </div><div id="c9" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Johannes Schindelin</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-07-15 13:33:39 CDT
        </span>
      </div>



<pre class="bz_comment_text" >What does --console --dry-run show?</pre>
    </div><div id="c10" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sebastian Rhode</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-07-15 14:06:21 CDT
        </span>
      </div>



<pre class="bz_comment_text" >Hi,

i found out some more things. When I start Fiji via:

...\Fiji\fiji-win32.exe --system

the memory limit is 1532MB, which is fine. And to my knowledge the --system option forces fiji to use the installed windows JVM, which is 1.6.0_22. And my Fiji uses 1.6.0_24.

By the way, the update java option from the updater gives me an error:

Could not find form of method 'post' in <a href="http://oracle.com/technetwork/java/javase/downloads/index.html">http://oracle.com/technetwork/java/javase/downloads/index.html</a>

Cheers,

Sebi</pre>
    </div><div id="c11" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Sebastian Rhode</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-07-18 09:30:32 CDT
        </span>
      </div>



<pre class="bz_comment_text" >-- console --dry-run shows:

C:\Programme\TILL Photonics\Live Acquisition\Fiji&gt;javaw -Dpython.cachedir.skip=true -Dplugins.dir=C:
\\LIVEAC~1\\Fiji -Xmx1536m -Xincgc -XX:PermSize=128m -Djava.class.path=C:\\PROGRA~1\\TILLPH~1\\LIVEA
jar;C:\\PROGRA~1\\TILLPH~1\\LIVEAC~1\\Fiji/jars/ij.jar -Dsun.java.command=Fiji -Dfiji.dir=C:\\PROGRA
~1\\Fiji -Dfiji.defaultLibPath=bin/client/jvm.dll -Dfiji.executable=fiji-win32.exe -Djava.library.pa
LPH~1\\LIVEAC~1\\Fiji/lib/win32 -Dsun.java2d.noddraw=true fiji.Main -port7</pre>
    </div><div id="c12" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Johannes Schindelin</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-10-20 02:33:22 CDT
        </span>
      </div>



<pre class="bz_comment_text" >I just fixed this in commit <a href="http://fiji.sc/cgi-bin/gitweb.cgi?p=fiji.git;a=commitdiff;h=313b2b70a665b00c5c273c54cf026b085512525b">http://fiji.sc/cgi-bin/gitweb.cgi?p=fiji.git;a=commitdiff;h=313b2b70a665b00c5c273c54cf026b085512525b</a>

Please download <a href="http://fiji.sc/snaps/fiji-win32.exe">http://fiji.sc/snaps/fiji-win32.exe</a> (or fiji-win64.exe) and test.</pre>
    </div><div id="c13" class="bz_comment">

      <div class="bz_comment_head">



        <span class="bz_comment_number">
          <a 
             href="#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Johannes Schindelin</span>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2012-01-05 23:58:53 CST
        </span>
      </div>



<pre class="bz_comment_text" >Ah, no complaints in over a month! That surely means that the bug is fixed.</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        



</div>

</body>
</html>
